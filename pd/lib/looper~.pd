#N canvas 173 71 1134 836 10;
#X obj 279 64 inlet~;
#X obj 280 351 tabwrite~ \$0-array;
#N canvas 114 199 450 300 (subpatch) 0;
#X array \$0-array 2.88e+06 float 2;
#X coords 0 300 1 299 200 140 0;
#X restore 686 329 graph;
#X msg 63 302 start;
#X msg 135 683 bang;
#X obj 134 810 outlet~;
#X obj 135 757 tabplay~ \$0-array;
#X obj 481 62 inlet;
#X obj 530 62 loadbang;
#X msg 530 82 stop;
#X msg 507 588 recording;
#X obj 46 428 timer;
#X msg 12 302 1;
#X msg 201 302 0;
#X floatatom 73 349 3 0 0 0 - - -;
#X obj 73 373 change;
#X obj 73 398 sel 0;
#X obj 667 222 s \$0-player;
#X obj 12 590 r \$0-player;
#X msg 93 233 const 0;
#X obj 93 257 s \$0-array;
#X obj 687 199 s \$0-recorder;
#X obj 12 65 r \$0-recorder;
#X obj 500 361 s \$0-sync;
#X obj 698 643 r \$0-sync;
#X text 477 5 INLET;
#X floatatom 205 623 5 0 0 0 - - -;
#X text 100 350 Recording ?;
#X obj 480 814 outlet;
#X msg 575 588 stopped;
#X msg 630 587 playing;
#X obj 630 621 symbol;
#X text 696 756 Synced ?;
#X obj 480 696 change;
#X text 244 624 Loop size;
#X msg 99 683 0;
#X msg 80 723 stop;
#X obj 12 624 route record clear stop play;
#X obj 507 557 route record clear stop play;
#X obj 135 723 metro;
#X symbolatom 630 722 10 0 0 0 - - -;
#X floatatom 698 738 5 0 0 0 - - -;
#X obj 648 245 s \$0-outlet;
#X obj 480 672 float;
#X floatatom 646 738 8 0 0 0 - - -;
#X obj 480 721 t f f;
#X obj 480 507 r \$0-outlet;
#X obj 630 739 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 480 532 t b a;
#X obj 648 169 t a a a;
#X msg 228 302 stop;
#X obj 12 99 route record clear stop play;
#X text 243 193 Stop recording in 1 second.;
#X obj 201 148 t b b;
#X obj 228 173 delay 1000;
#X text 683 311 \$0-array;
#X text 685 350 WARNING !;
#X obj 93 131 t b b b;
#X msg 112 164 0;
#X obj 12 131 t b b b b;
#X obj 205 654 sel 0;
#X obj 112 187 s \$0-loopsize;
#X obj 205 591 r \$0-loopsize;
#X obj 507 641 r \$0-loopsize;
#X obj 520 338 s \$0-loopsize;
#X obj 53 652 t b b;
#X text 627 756 Loop size;
#X text 479 24 Arguments can be commands \, or a float;
#X text 477 37 (which becomes the new loop size);
#X text 478 454 OUTLET;
#X text 686 365 Displaying the array causes XRUNS on tabwrite~ stop.
;
#X text 685 377 I think PD redraws the graph becauses this patch has
grap-on-parent enabled \, even if the graph is not inside the red canvas.
And that causes XRUNs.;
#X text 11 543 PLAYER;
#X text 12 561 Start/stop playing the loop;
#X text 243 222 is synced to a longer size.;
#X text 244 208 We need that in case loopsize;
#X text 479 472 Display current state for user \, and output loop size
(only when changed);
#X text 11 6 RECORDER;
#X text 12 23 Start/stop recording the loop;
#X text 12 35 Set loopsize for reader;
#X text 117 395 Stop timer only;
#X text 117 409 if state changed;
#X obj 46 472 s \$0-loopsize;
#X text 91 276 Clean array;
#X text 110 205 Reset loopsize;
#X text 246 649 Change metro interval;
#X text 247 663 only for non-zero values;
#X obj 481 310 t b b f;
#X obj 481 384 s \$0-outlet;
#X obj 915 698 soundfiler;
#X obj 988 500 r \$0-loopsize;
#X obj 915 648 pack s f \$0;
#X obj 1015 558 samplerate~;
#X obj 1015 583 / 1000;
#X obj 988 616 *;
#X obj 988 529 t f b;
#X msg 915 673 write -nframes \$2 \$1 \$3-array;
#X obj 517 152 route load save;
#X obj 560 186 s \$0-saver;
#X obj 915 500 r \$0-saver;
#X text 913 454 SAVER;
#X text 913 473 Save loop to file;
#X obj 918 144 soundfiler;
#X text 916 7 LOADER;
#X obj 918 56 r \$0-loader;
#X msg 918 120 read \$1 \$2-array;
#X text 916 26 Load loop from file;
#X obj 918 95 pack s \$0;
#X obj 945 213 samplerate~;
#X obj 945 238 / 1000;
#X obj 918 184 t f b;
#X obj 918 271 /;
#X obj 918 298 s \$0-loopsize;
#X obj 740 665 r \$0-unsync;
#X msg 698 668 1;
#X msg 740 687 0;
#X obj 507 771 s \$0-unsync;
#X obj 536 258 s \$0-unsync;
#X obj 517 281 s \$0-outlet;
#X obj 517 206 t b b a;
#X obj 556 235 s \$0-loader;
#X obj 481 114 route float;
#X obj 507 747 select 0;
#X text 765 803 (C) Copyright 2014 \, released under the GNU GPL v3
or later;
#X connect 0 0 1 0;
#X connect 3 0 1 0;
#X connect 4 0 39 0;
#X connect 6 0 5 0;
#X connect 7 0 121 0;
#X connect 8 0 9 0;
#X connect 9 0 121 0;
#X connect 10 0 31 0;
#X connect 11 0 82 0;
#X connect 12 0 14 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 16 0 11 1;
#X connect 18 0 37 0;
#X connect 19 0 20 0;
#X connect 22 0 51 0;
#X connect 24 0 114 0;
#X connect 26 0 60 0;
#X connect 29 0 31 0;
#X connect 30 0 31 0;
#X connect 31 0 40 0;
#X connect 33 0 45 0;
#X connect 35 0 39 0;
#X connect 36 0 6 0;
#X connect 37 0 65 0;
#X connect 37 1 65 0;
#X connect 37 2 65 0;
#X connect 37 3 4 0;
#X connect 38 0 10 0;
#X connect 38 1 29 0;
#X connect 38 2 29 0;
#X connect 38 3 30 0;
#X connect 39 0 6 0;
#X connect 43 0 33 0;
#X connect 45 0 28 0;
#X connect 45 1 44 0;
#X connect 45 1 47 0;
#X connect 45 1 122 0;
#X connect 46 0 48 0;
#X connect 48 0 43 0;
#X connect 48 1 38 0;
#X connect 49 0 42 0;
#X connect 49 1 17 0;
#X connect 49 2 21 0;
#X connect 50 0 1 0;
#X connect 51 0 59 0;
#X connect 51 1 57 0;
#X connect 51 2 53 0;
#X connect 51 3 53 0;
#X connect 53 0 13 0;
#X connect 53 1 54 0;
#X connect 54 0 50 0;
#X connect 57 0 19 0;
#X connect 57 1 58 0;
#X connect 57 2 53 0;
#X connect 58 0 61 0;
#X connect 59 0 12 0;
#X connect 59 1 58 0;
#X connect 59 2 11 0;
#X connect 59 3 3 0;
#X connect 60 1 39 1;
#X connect 62 0 26 0;
#X connect 63 0 43 1;
#X connect 65 0 35 0;
#X connect 65 1 36 0;
#X connect 87 0 88 0;
#X connect 87 1 23 0;
#X connect 87 2 64 0;
#X connect 90 0 95 0;
#X connect 91 0 96 0;
#X connect 92 0 93 0;
#X connect 93 0 94 1;
#X connect 94 0 91 1;
#X connect 95 0 94 0;
#X connect 95 1 92 0;
#X connect 96 0 89 0;
#X connect 97 0 119 0;
#X connect 97 1 98 0;
#X connect 97 2 49 0;
#X connect 99 0 91 0;
#X connect 102 0 110 0;
#X connect 104 0 107 0;
#X connect 105 0 102 0;
#X connect 107 0 105 0;
#X connect 108 0 109 0;
#X connect 109 0 111 1;
#X connect 110 0 111 0;
#X connect 110 1 108 0;
#X connect 111 0 112 0;
#X connect 113 0 115 0;
#X connect 114 0 41 0;
#X connect 115 0 41 0;
#X connect 119 0 118 0;
#X connect 119 1 117 0;
#X connect 119 2 120 0;
#X connect 121 0 87 0;
#X connect 121 1 97 0;
#X connect 122 0 116 0;
#X coords 0 -1 1 1 100 50 1 630 704;
